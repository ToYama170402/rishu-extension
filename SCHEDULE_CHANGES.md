# 時間割変更日設定機能

## 概要

本機能は、既存のGoogleカレンダー連携機能に時間割変更日（祝日振替や特別授業日）を設定できる機能を追加するものです。

## 主な機能

### 1. 祝日の自動検出・除外

- GoogleカレンダーAPIの日本の祝日カレンダーから祝日情報を自動取得
- 祝日に該当する日は自動的に講義を追加しない

### 2. 時間割変更日設定UI

- 「何月何日が何曜日の時間割になる」形式での設定
- 日付選択機能
- 変更先の曜日選択機能（月〜日）
- 変更内容の一覧表示・編集・削除機能
- 重複日付チェック
- 期間外日付チェック

### 3. カレンダー生成時の変更適用

- 設定された変更日に対して適切な曜日の時間割を適用
- 祝日は自動的に除外
- 個別イベント作成により精密な制御を実現

## 使用方法

1. **カレンダーに追加**ボタンをクリック
2. カレンダー、開始日、終了日を設定
3. 「時間割変更設定」セクションで**設定**をクリック
4. 変更したい日付と変更先の曜日を選択
5. 必要に応じて説明を入力
6. **追加**ボタンで設定を追加
7. **追加する**ボタンでカレンダーイベントを作成

## 技術仕様

### 新しい型定義

```typescript
export type ScheduleChange = {
  id: string
  date: string // YYYY-MM-DD format
  fromDay: string // 元の曜日（月、火、水、木、金、土、日）
  toDay: string // 変更先の曜日（月、火、水、木、金、土、日）
  description?: string // 変更内容の説明
}

export type Holiday = {
  date: string // YYYY-MM-DD format
  summary: string
}
```

### 主要な実装変更

#### background.ts

- `getHolidays()` 関数を追加
- 日本の祝日カレンダーAPIへのアクセス
- `GET_HOLIDAYS` メッセージハンドラを追加

#### courseList.tsx

- 時間割変更管理機能の追加
- 祝日検出機能の追加
- カレンダーイベント作成ロジックの改良（繰り返しイベントから個別イベントに変更）
- `ScheduleChangeForm` コンポーネントの追加
- UI拡張による設定インターフェース

### カレンダーイベント作成の変更点

従来の繰り返しルール（RRULE）による一括作成から、日付ごとの個別イベント作成に変更：

- **利点**: 祝日除外や時間割変更の精密な制御が可能
- **処理**: 指定期間内の各日付について個別にチェックし、条件に応じてイベントを作成
- **API制限対策**: イベント作成間に100msの遅延を挿入

## 期待される効果

- より正確な授業スケジュールの管理
- 祝日の自動除外による手動調整の削減
- 祝日振替授業への対応
- ユーザビリティの向上

## 制限事項

- 設定はセッション単位での保持（永続化なし）
- APIレート制限により大量のイベント作成時は時間がかかる場合がある
- 日本の祝日カレンダーのみサポート
